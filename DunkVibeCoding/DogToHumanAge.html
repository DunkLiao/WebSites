<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>äººç‹—æ›ç®—æ­²æ•¸å™¨ â€” è²¼åœ–æ‰‹ç¹ªé¢¨</title>

  <!-- æ‰‹å¯«é¢¨å­—å‹ (Google Fonts) -->
  <link href="https://fonts.googleapis.com/css2?family=Patrick+Hand&display=swap" rel="stylesheet">

  <style>
    :root{
      --bg: #fff6f9;
      --card: #fff;
      --accent: #ff7aa2;
      --accent-2: #ffd6e6;
      --text: #2b2b2b;
      --muted: #6b6b6b;
      --shadow: 0 8px 30px rgba(43,27,40,0.08);
      --radius: 16px;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family: "Helvetica Neue", Arial, sans-serif;
      background: linear-gradient(180deg, #fff6f9 0%, #fff9fb 100%);
      color:var(--text);
      display:flex;
      align-items:flex-start;
      justify-content:center;
      padding:28px 18px 140px; /* bottom padding for fixed footer */
    }

    /* ä¸»å®¹å™¨ */
    .wrap{
      width:100%;
      max-width:920px;
      display:grid;
      grid-template-columns: 420px 1fr;
      gap:20px;
      align-items:start;
    }

    /* å·¦å´å¡ç‰‡ï¼šè¼¸å…¥èˆ‡çµæœ */
    .panel{
      background:var(--card);
      border-radius:var(--radius);
      padding:18px;
      box-shadow:var(--shadow);
      position:relative;
      overflow:visible;
    }
    h1{
      font-family: "Patrick Hand", "Helvetica Neue", Arial, sans-serif;
      font-size:26px;
      margin:6px 0 12px;
      display:flex;
      align-items:center;
      gap:10px;
    }
    .subtitle{
      font-size:13px;
      color:var(--muted);
      margin-bottom:12px;
    }

    label{font-weight:600; font-size:14px; display:block; margin-bottom:6px;}
    input[type="date"], select{
      width:100%;
      padding:12px;
      border-radius:10px;
      border:1px dashed #ffd6e6;
      background:linear-gradient(180deg,#fff,#fff9fb);
      font-size:15px;
    }

    .controls{margin-top:12px}
    button.calc {
      margin-top:12px;
      width:100%;
      padding:12px;
      border-radius:12px;
      border:none;
      font-weight:700;
      font-size:16px;
      background:linear-gradient(180deg,var(--accent),#ff5b8a);
      color:white;
      cursor:pointer;
      box-shadow: 0 8px 18px rgba(255,122,162,0.18);
      transition: transform .18s ease, box-shadow .18s ease;
    }
    /* hover å¾®æ”¾å¤§ï¼ˆDï¼‰ */
    button.calc:hover{
      transform: scale(1.04);
      box-shadow: 0 14px 30px rgba(255,122,162,0.22);
    }

    .result-box{
      margin-top:18px;
      background: linear-gradient(180deg,#fff,#fff7fb);
      border-radius:12px;
      padding:14px;
      border:1px solid rgba(255,185,210,0.4);
      display:flex;
      gap:12px;
      align-items:center;
    }
    .result-text{
      font-size:15px;
      line-height:1.4;
    }
    .result-key{
      font-size:20px;
      font-weight:800;
      color:#e83b7b;
    }

    /* å³å´ï¼šæ’ç•« + èªªæ˜å¡ */
    .art-panel{
      display:flex;
      flex-direction:column;
      gap:14px;
    }
    .sticker {
      background: linear-gradient(180deg,#fff,#fffaf2);
      border-radius:18px;
      padding:18px;
      box-shadow: var(--shadow);
      display:flex;
      gap:12px;
      align-items:center;
    }

    /* æ‰‹ç¹ªç‹—ç‹—æ’ç•«å€ */
    .dog-wrap{
      width:140px;
      height:140px;
      position:relative;
      flex: 0 0 140px;
      display:flex;
      align-items:center;
      justify-content:center;
    }

    /* æ’ç•«ï¼šSVG å®¹å™¨ */
    .dog-svg{
      width:120px;
      height:120px;
      transform-origin: center bottom;
      position:relative;
    }

    /* æ‘‡å°¾å·´å‹•ç•« (B) */
    @keyframes wag {
      0% { transform: rotate(6deg); }
      25% { transform: rotate(-12deg); }
      50% { transform: rotate(8deg); }
      75% { transform: rotate(-8deg); }
      100% { transform: rotate(6deg); }
    }
    .tail {
      transform-origin: 8px 8px;
      animation: wag 1s ease-in-out infinite;
    }

    /* çœ¨çœ¼å‹•ç•« (B) */
    @keyframes blink {
      0%, 80%, 100% { transform: scaleY(1); }
      85% { transform: scaleY(0.12); }
      87% { transform: scaleY(1); }
    }
    .eye {
      transform-origin: center;
      animation: blink 4.5s infinite;
    }

    /* æ’ç•«æ–‡å­—å¡ */
    .info-card{
      padding:10px;
      background:linear-gradient(180deg,#fff,#fff7fb);
      border-radius:12px;
      border:1px solid rgba(0,0,0,0.04);
      font-size:14px;
      color:var(--muted);
      line-height:1.5;
    }

    /* èªªæ˜å€ï¼ˆå›ºå®šåœ¨é é¢ä¸‹æ–¹ï¼‰ */
    .formula-footer{
      position:fixed;
      left:0;
      right:0;
      bottom:0;
      background:linear-gradient(180deg,#fff,#fff8fb);
      border-top: 1px solid rgba(0,0,0,0.04);
      padding:18px 22px;
      box-shadow: 0 -10px 30px rgba(0,0,0,0.04);
    }
    .formula-inner{
      max-width:1100px;
      margin:0 auto;
      display:flex;
      gap:18px;
      align-items:flex-start;
      justify-content:space-between;
      flex-wrap:wrap;
    }
    .table-block{
      background:#fff;
      border-radius:12px;
      padding:12px;
      box-shadow: 0 6px 20px rgba(0,0,0,0.04);
      min-width:420px;
    }
    .table-block table{
      border-collapse:collapse;
      width:100%;
      font-size:13px;
    }
    .table-block th, .table-block td{
      border-bottom:1px dashed #f3dbe4;
      padding:8px 6px;
      text-align:center;
    }
    .table-block th{
      font-weight:700;
      color:#7b1d3e;
      background: linear-gradient(90deg,#fff7fb,#fff0f7);
      border-radius:6px;
    }

    .card-block{
      max-width:420px;
      min-width:280px;
      background:linear-gradient(180deg,#fff,#fff9fb);
      padding:12px;
      border-radius:12px;
      box-shadow:0 6px 20px rgba(0,0,0,0.03);
    }
    .card{
      display:flex;
      gap:8px;
      align-items:center;
      margin-bottom:10px;
    }
    .card svg{flex:0 0 58px;}
	
	.calculator-box {
	  position: relative;
	  z-index: 20;
	}
	
	.info-section {
	  position: relative;
	  z-index: 1;
	}


    /* éŸ¿æ‡‰å¼ */
    @media (max-width:900px){
      .wrap{grid-template-columns: 1fr; max-width:560px;}
      .dog-wrap{width:110px;height:110px}
      .sticker{align-items:flex-start}
    }
  </style>
</head>
<body>

  <div class="calculator-box " role="main" aria-label="äººç‹—æ›ç®—æ­²æ•¸å™¨">
    <!-- å·¦ï¼šè¼¸å…¥ã€çµæœ -->
    <section class="panel" aria-labelledby="appTitle">
      <h1 id="appTitle">ğŸ¶ äººç‹—æ›ç®—æ­²æ•¸å™¨ï¼ˆè²¼åœ–æ‰‹ç¹ªé¢¨ï¼‰</h1>
      <div class="subtitle">è¼¸å…¥å‡ºç”Ÿæ—¥æœŸ â†’ æœƒé¡¯ç¤ºç‹—å¹´é½¡ï¼ˆä¾é«”å‹ï¼‰èˆ‡æ›ç®—æˆäººé¡å¹´é½¡</div>

      <label for="birth">ç‹—ç‹—çš„å‡ºç”Ÿæ—¥æœŸ</label>
      <input id="birth" type="date" max="" aria-describedby="birthDesc" />

      <label for="size">ç‹—ç‹—é«”å‹</label>
      <select id="size" aria-label="é¸æ“‡ç‹—ç‹—é«”å‹">
        <option value="small">å°å‹çŠ¬ï¼ˆ9kg ä»¥ä¸‹ï¼‰</option>
        <option value="medium">ä¸­å‹çŠ¬ï¼ˆ9â€“23kgï¼‰</option>
        <option value="large">å¤§å‹çŠ¬ï¼ˆ23â€“45kgï¼‰</option>
        <option value="giant">å·¨å‹çŠ¬ï¼ˆ45kg ä»¥ä¸Šï¼‰</option>
      </select>

      <div class="controls">
        <button class="calc" id="calcBtn" aria-label="é–‹å§‹è¨ˆç®—">é–‹å§‹è¨ˆç®—</button>
      </div>

      <div id="output" class="result-box" style="display:none;" aria-live="polite">
        <div style="flex:1">
          <div class="result-text">
            ç‹—ç‹—ï¼ˆ<span id="showSizeLabel">-</span>ï¼‰ç¾åœ¨å¤§ç´„ <span class="result-key" id="dogYears">-</span> æ­²ï¼ˆç‹—å¹´é½¡ï¼‰<br>
            æ›ç®—æˆäººé¡å¹´é½¡å¤§ç´„æ˜¯ <span class="result-key" id="humanYears">-</span> æ­²
          </div>
        </div>

        <!-- å°å‹è²¼ç´™æ’ç•«ï¼ˆåŒæ­¥å‹•ç•«ï¼‰ -->
        <div style="width:120px;display:flex;align-items:center;justify-content:center">
          <div style="width:86px;height:86px;border-radius:12px;background:linear-gradient(180deg,#fff,#fff9fb);display:flex;align-items:center;justify-content:center;border:1px dashed #ffd6e6;">
            <!-- ç°¡å–® SVG ç‹—ç‹— (å°¾å·´èˆ‡çœ¼ç›æœƒå‹•ç•«) -->
            <svg class="dog-svg" viewBox="0 0 120 120" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false">
              <!-- body -->
              <ellipse cx="60" cy="70" rx="38" ry="26" fill="#fff" stroke="#2b2b2b" stroke-width="2" />
              <!-- ear -->
              <path d="M36 48 C28 44, 26 32, 38 30 C50 28, 44 46, 36 48 Z" fill="#ffd6e6" stroke="#2b2b2b" stroke-width="1.6"/>
              <path d="M84 48 C92 44, 94 32, 82 30 C70 28, 76 46, 84 48 Z" fill="#ffd6e6" stroke="#2b2b2b" stroke-width="1.6"/>

              <!-- head -->
              <circle cx="60" cy="44" r="24" fill="#fff" stroke="#2b2b2b" stroke-width="2" />
              <!-- eye left -->
              <ellipse class="eye" cx="52" cy="42" rx="3.8" ry="4.8" fill="#2b2b2b"/>
              <!-- eye right -->
              <ellipse class="eye" cx="68" cy="42" rx="3.8" ry="4.8" fill="#2b2b2b"/>
              <!-- nose -->
              <ellipse cx="60" cy="50" rx="4.8" ry="3.4" fill="#2b2b2b"/>
              <!-- mouth -->
              <path d="M56 54 Q60 58 64 54" stroke="#2b2b2b" stroke-width="1.6" fill="none" stroke-linecap="round"/>
              <!-- tail (separate group for animation) -->
              <g transform="translate(98,64) rotate(6)" class="tail">
                <path d="M0 0 C8 -4, 12 -12, 6 -18" stroke="#2b2b2b" stroke-width="3" fill="none" stroke-linecap="round"/>
                <path d="M2 -2 C10 -6, 14 -14, 8 -20" stroke="#ff5b8a" stroke-width="3" fill="none" stroke-linecap="round" opacity="0.6"/>
              </g>
            </svg>
          </div>
        </div>
      </div>

      <div style="margin-top:12px" class="info-card">
        å°æç¤ºï¼šå»ºè­°è¼¸å…¥ **æº–ç¢ºå‡ºç”Ÿæ—¥æœŸ**ï¼Œçµæœæœƒä»¥ä»Šå¤©æ—¥æœŸä½œç‚ºè¨ˆç®—åŸºç¤ä¸¦ç”¨è¡¨æ ¼è³‡æ–™é€²è¡Œæ›ç®—ï¼ˆè‹¥ç‚ºéæ•´æ­²ï¼Œæœƒä»¥ç›¸é„°è¡¨æ ¼é»åšç·šæ€§æ’å€¼ï¼‰ã€‚
      </div>
    </section>

    <!-- å³å´ï¼šå¤§æ’ç•« + å¡ç‰‡ -->
    <aside class="art-panel">
      <div class="sticker" aria-hidden="true">
        <div class="dog-wrap">
          <!-- å¤§æ‰‹ç¹ªè²¼åœ–é¢¨ç‹—ç‹—ï¼ˆå‹•ç•«ï¼šçœ¨çœ¼ + æ–å°¾å·´ï¼‰ -->
          <svg class="dog-svg" viewBox="0 0 160 160" xmlns="http://www.w3.org/2000/svg" role="img" aria-label="å¯æ„›ç‹—ç‹—æ’ç•«">
            <!-- shadow -->
            <ellipse cx="80" cy="140" rx="44" ry="8" fill="#ffd6e6" opacity="0.35"/>
            <!-- body -->
            <ellipse cx="80" cy="100" rx="54" ry="36" fill="#fff" stroke="#2b2b2b" stroke-width="3"/>
            <!-- head -->
            <circle cx="80" cy="58" r="36" fill="#fff" stroke="#2b2b2b" stroke-width="3"/>
            <!-- ears -->
            <path d="M50 46 C38 36, 34 28, 48 22 C58 18, 64 38, 50 46 Z" fill="#ffd6e6" stroke="#2b2b2b" stroke-width="2"/>
            <path d="M110 46 C122 36, 126 28, 112 22 C102 18, 96 38, 110 46 Z" fill="#ffd6e6" stroke="#2b2b2b" stroke-width="2"/>

            <!-- eyes (blink) -->
            <g transform="translate(0,0)">
              <ellipse class="eye" cx="70" cy="60" rx="5.2" ry="6.4" fill="#2b2b2b"/>
              <ellipse class="eye" cx="90" cy="60" rx="5.2" ry="6.4" fill="#2b2b2b"/>
            </g>

            <!-- nose & mouth -->
            <ellipse cx="80" cy="72" rx="5.5" ry="4.2" fill="#2b2b2b"/>
            <path d="M76 78 Q80 84 84 78" stroke="#2b2b2b" stroke-width="1.8" fill="none" stroke-linecap="round"/>

            <!-- tail group -->
            <g transform="translate(140,98) rotate(8)" class="tail">
              <path d="M0 0 C10 -6, 16 -18, 8 -26" stroke="#2b2b2b" stroke-width="4" fill="none" stroke-linecap="round"/>
              <path d="M4 -4 C14 -10, 20 -22, 12 -30" stroke="#ff5b8a" stroke-width="3.2" fill="none" stroke-linecap="round" opacity="0.7"/>
            </g>

            <!-- blush -->
            <ellipse cx="60" cy="74" rx="8" ry="5.2" fill="#ffd6e6" opacity="0.9"/>
            <ellipse cx="100" cy="74" rx="8" ry="5.2" fill="#ffd6e6" opacity="0.9"/>

            <!-- little scarf -->
            <path d="M80 86 C66 94, 58 94, 52 92 C50 96, 68 106, 86 98 L80 86 Z" fill="#ff5b8a" stroke="#2b2b2b" stroke-width="1.6"/>
          </svg>
        </div>

        <div style="flex:1">
          <div style="font-family: 'Patrick Hand'; font-size:18px; color:#7b1d3e; margin-bottom:6px;">Helloï¼æˆ‘æ˜¯è²¼åœ–ç‹—ç‹—</div>
          <div style="color:var(--muted); font-size:14px; line-height:1.5">
            ä¾†è©¦è©¦çœ‹æŠŠä½ çš„ç‹—ç‹—å¹´é½¡æ›ç®—æˆäººé¡å¹´é½¡å§ï¼æˆ‘æœƒæ–å°¾å·´ã€çœ¨çœ¼ï¼Œé‚„æœƒç”¨æˆ‘å€‘çš„æ›ç®—è¡¨å¹«ä½ ç²¾æº–æ›ç®—ï¼ˆæœ‰æ’å€¼ï¼‰ã€‚
          </div>
        </div>
      </div>

      <div class="info-card" style="font-size:14px">
        <strong style="display:block; margin-bottom:6px;">åŠŸèƒ½ç‰¹è‰²</strong>
        â€¢ æ‰‹ç¹ªè²¼åœ–é¢¨ UIï¼ˆLINE è²¼åœ–æ„Ÿï¼‰<br>
        â€¢ å›ºå®šé¡¯ç¤ºè©³ç´°æ›ç®—è¡¨èˆ‡èªªæ˜ï¼ˆé åº•ï¼‰<br>
        â€¢ ç‹—ç‹—æœƒçœ¨çœ¼èˆ‡æ–å°¾å·´å‹•ç•«ï¼ˆæŒçºŒæ’­æ”¾ï¼‰<br>
        â€¢ æŒ‰éˆ•æœ‰å¾®æ”¾å¤§äº’å‹•
      </div>
    </aside>
  </div>

  <!-- å›ºå®šä¸‹æ–¹ï¼šè©³ç´°æ›ç®—å…¬å¼ï¼ˆè¡¨æ ¼ + åœ–æ–‡å¡ï¼‰ -->
  <footer class="info-section" aria-labelledby="formulaTitle">
    <div class="formula-inner">
      <div class="table-block" role="region" aria-label="æ›ç®—è¡¨">
        <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:8px">
          <div style="font-weight:800;color:#7b1d3e;">è©³ç´°æ›ç®—è¡¨</div>
          <div style="font-size:13px;color:var(--muted)">è³‡æ–™ä¾†æºï¼š<a href='https://hehopets.com/age-conversion' target='about:blank'>@çŠ¬è²“å¹´é½¡æ›ç®—@</a><a href='https://pets.edh.tw/blog/dog-age-conversion-guide' target='about:blank'>@æ—©å®‰æ¯›å¥åº·@</a></div>
        </div>

        <!-- æ›ç®—è³‡æ–™è¡¨ (ä¾†è‡ª CSV) -->
        <table aria-hidden="false">
          <thead>
            <tr>
              <th>ç‹—ç‹—å¹´é½¡</th>
              <th><p><b>å°å‹çŠ¬ï¼ˆ9kg ä»¥ä¸‹ï¼‰</b></p>æ›ç®—è‡³äººé¡å¹´é½¡</th>
              <th><p><b>ä¸­å‹çŠ¬ï¼ˆ9â€“23kgï¼‰</b></p>æ›ç®—è‡³äººé¡å¹´é½¡</th>
              <th><p><b>å¤§å‹çŠ¬ï¼ˆ23â€“45kgï¼‰</b></p>æ›ç®—è‡³äººé¡å¹´é½¡</th>
              <th><p><b>å·¨å‹çŠ¬ï¼ˆ45kg ä»¥ä¸Šï¼‰</b></p>æ›ç®—è‡³äººé¡å¹´é½¡</th>
            </tr>
          </thead>
          <tbody id="dataTableBody">
            <!-- JS æœƒå¡«å…¥è¡¨æ ¼åˆ— -->
          </tbody>
        </table>
      </div>

      <div class="card-block" role="region" aria-label="æ›ç®—å…¬å¼èªªæ˜">
        <div style="font-weight:800;color:#7b1d3e;margin-bottom:8px" id="formulaTitle">æ›ç®—å…¬å¼èªªæ˜ï¼ˆè¡¨æ ¼ + åœ–æ–‡ï¼‰</div>

        <!-- åœ–æ–‡å¡ç‰‡ â‘¡+â‘¢ -->
        <div class="card">
          <svg width="58" height="58" viewBox="0 0 64 64" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
            <circle cx="32" cy="32" r="30" fill="#fff" stroke="#2b2b2b" stroke-width="1.8"/>
            <path d="M18 36 Q32 46 46 36" stroke="#ff5b8a" stroke-width="2.4" fill="none" stroke-linecap="round"/>
            <circle cx="24" cy="28" r="3.2" fill="#2b2b2b"/>
            <circle cx="40" cy="28" r="3.2" fill="#2b2b2b"/>
          </svg>
          <div>
            <div style="font-weight:700">æ›ç®—æ€è·¯</div>
            <div style="color:var(--muted);font-size:13px">ä½¿ç”¨ä½ æä¾›çš„å¹´é½¡è¡¨ï¼ˆCSVï¼‰ã€‚è‹¥è¨ˆç®—åˆ°çš„ç‹—å¹´é½¡ä»‹æ–¼å…©å€‹è¡¨æ ¼é»ä¹‹é–“ï¼Œæœƒä»¥ <strong>ç·šæ€§æ’å€¼</strong> ä¼°ç®—å°æ‡‰çš„äººé¡å¹´é½¡ã€‚</div>
          </div>
        </div>

        <div class="card">
          <svg width="58" height="58" viewBox="0 0 64 64" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
            <rect x="6" y="10" width="52" height="44" rx="6" fill="#fff" stroke="#2b2b2b" stroke-width="1.6"/>
            <text x="14" y="28" font-size="10" fill="#7b1d3e" font-weight="700">è‹¥ dogY åœ¨</text>
            <text x="14" y="40" font-size="10" fill="#6b6b6b">pointA..pointB â†’ interpolate</text>
          </svg>
          <div>
            <div style="font-weight:700">å…¬å¼ï¼ˆç°¡åŒ–ï¼‰</div>
            <div style="color:var(--muted);font-size:13px">
              è‹¥ <em>dogY</em> åœ¨ <em>A</em>ï¼ˆäººé½¡ = HAï¼‰èˆ‡ <em>B</em>ï¼ˆäººé½¡ = HBï¼‰ä¹‹é–“ï¼š<br>
              <code>human â‰ˆ HA + (HB-HA) * (dogY - A) / (B - A)</code>
            </div>
          </div>
        </div>

        <div style="font-size:13px;color:var(--muted);margin-top:8px">
          è¡¨æ ¼åŒ…å«ï¼š1ã€2ã€3ã€5ã€7ã€10ã€12ã€15 æ­²å°æ‡‰çš„äººé¡å¹´é½¡ã€‚
        </div>
      </div>
    </div>
  </footer>

  <script>
    // ---- 1. CSV è³‡æ–™ï¼ˆä¾†è‡ªä¸Šå‚³çš„ table.csvï¼‰ ----
    // ç‚ºäº†æ–¹ä¾¿å‰ç«¯ä½¿ç”¨ï¼Œæˆ‘æŠŠ CSV è§£æå¾Œçš„è³‡æ–™å¯«æˆä¸‹é¢çš„çµæ§‹ï¼ˆæ•¸å­—ï¼‰
    // è³‡æ–™ä¾†æºï¼ˆCSVï¼‰:
    const agePoints = [
      { dog: 1, small: 15, medium: 15, large: 15, giant: 12 },
      { dog: 2, small: 24, medium: 24, large: 24, giant: 22 },
      { dog: 3, small: 28, medium: 28, large: 28, giant: 31 },
      { dog: 5, small: 36, medium: 36, large: 36, giant: 45 },
      { dog: 7, small: 44, medium: 47, large: 50, giant: 56 },
      { dog: 10, small: 56, medium: 60, large: 66, giant: 79 },
      { dog: 12, small: 64, medium: 69, large: 77, giant: 93 },
      { dog: 15, small: 76, medium: 83, large: 93, giant: 114 }
    ];

    // å°‡è¡¨æ ¼å…§å®¹å¡«å…¥ footer çš„ table body
    (function fillTable(){
      const tbody = document.getElementById('dataTableBody');
      tbody.innerHTML = '';
      agePoints.forEach(pt=>{
        const tr = document.createElement('tr');
        tr.innerHTML = `
          <td>${pt.dog} æ­²</td>
          <td>${pt.small} æ­²</td>
          <td>${pt.medium} æ­²</td>
          <td>${pt.large} æ­²</td>
          <td>${pt.giant} æ­²</td>
        `;
        tbody.appendChild(tr);
      });
    })();

    // è¨ˆç®—ä»Šå¤©ç‚º max date
    (function setMaxDate(){
      const d = new Date();
      const yyyy = d.getFullYear();
      const mm = String(d.getMonth()+1).padStart(2,'0');
      const dd = String(d.getDate()).padStart(2,'0');
      document.getElementById('birth').max = `${yyyy}-${mm}-${dd}`;
    })();

    // é¸å–® label é¡¯ç¤º
    const sizeLabelMap = {
      small: "å°å‹çŠ¬ï¼ˆ9kg ä»¥ä¸‹ï¼‰",
      medium: "ä¸­å‹çŠ¬ï¼ˆ9â€“23kgï¼‰",
      large: "å¤§å‹çŠ¬ï¼ˆ23â€“45kgï¼‰",
      giant: "å·¨å‹çŠ¬ï¼ˆ45kg ä»¥ä¸Šï¼‰"
    };

    // ç·šæ€§æ’å€¼å‡½å¼ï¼šæ‰¾é›¢æ•£é»ä¸­æœ€æ¥è¿‘çš„ä¸‹ç•Œèˆ‡ä¸Šç•Œå¾Œåšæ’å€¼
    function humanAgeFromDogYears(dogYears, sizeKey){
      // ç¯„åœè€ƒé‡ï¼šè‹¥å°æ–¼æœ€å°é»ï¼Œç”¨æœ€å°é»å€¼ï¼›è‹¥å¤§æ–¼æœ€å¤§é»ï¼Œç”¨æœ€å¤§é»å€¼
      if (dogYears <= agePoints[0].dog) return agePoints[0][sizeKey];
      const last = agePoints[agePoints.length-1];
      if (dogYears >= last.dog) return last[sizeKey];

      // æ‰¾åˆ° A <= dogYears <= B
      for (let i = 0; i < agePoints.length - 1; i++){
        const A = agePoints[i].dog, B = agePoints[i+1].dog;
        if (dogYears >= A && dogYears <= B) {
          const HA = agePoints[i][sizeKey];
          const HB = agePoints[i+1][sizeKey];
          // è‹¥æ°å¥½ç­‰æ–¼ Aï¼Œå›å‚³ HA
          if (dogYears === A) return HA;
          // ç·šæ€§æ’å€¼
          const t = (dogYears - A) / (B - A);
          const interpolated = HA + (HB - HA) * t;
          return Math.round(interpolated * 10) / 10; // ä¸€ä½å°æ•¸
        }
      }
      // fallback
      return last[sizeKey];
    }

    // è¨ˆç®—ç‹—å¹´é½¡ï¼ˆä»¥å¹´ç‚ºå–®ä½ï¼Œä¿ç•™ä¸€ä½å°æ•¸ï¼‰
    function calcDogYearsFromBirth(birthDateStr){
      const birth = new Date(birthDateStr + 'T00:00:00');
      const now = new Date();
      if (isNaN(birth)) return null;
      const diffMs = now - birth;
      const years = diffMs / (1000 * 60 * 60 * 24 * 365.2425); // å¹³å‡å¤©æ•¸ï¼ˆè€ƒæ…®é–å¹´ï¼‰
      return Math.round(years * 10) / 10;
    }

    // UI äº’å‹•
    const btn = document.getElementById('calcBtn');
    btn.addEventListener('click', ()=>{
      const birth = document.getElementById('birth').value;
      const size = document.getElementById('size').value;
      if (!birth) {
        alert('è«‹å…ˆè¼¸å…¥ç‹—ç‹—çš„å‡ºç”Ÿæ—¥æœŸ ğŸ˜Š');
        return;
      }
      // è¨ˆç®—
      const dogY = calcDogYearsFromBirth(birth);
      const humanY = humanAgeFromDogYears(dogY, size);

      // é¡¯ç¤º
      document.getElementById('dogYears').textContent = dogY;
      document.getElementById('humanYears').textContent = humanY;
      document.getElementById('showSizeLabel').textContent = sizeLabelMap[size];

      document.getElementById('output').style.display = 'flex';
      // å°å‹•ç•«ï¼šè®“çµæœå€æ·¡å…¥
      const out = document.getElementById('output');
      out.style.opacity = 0;
      out.animate([{opacity:0, transform:'translateY(10px)'},{opacity:1, transform:'translateY(0)'}], {duration:300, easing:'ease-out', fill:'forwards'});
    });

    // === Accessibility: allow Enter key to trigger calculation when focus on date/select ===
    document.getElementById('birth').addEventListener('keypress', (e)=>{
      if (e.key === 'Enter') btn.click();
    });
    document.getElementById('size').addEventListener('keypress', (e)=>{
      if (e.key === 'Enter') btn.click();
    });

    // è¨»ï¼šå¦‚æœä½ å¸Œæœ›æ”¹æˆã€Œä½¿ç”¨è€…ä¸Šå‚³ CSV å¾Œå‹•æ…‹è®€å–ã€ï¼Œæˆ‘å¯ä»¥å¹«ä½ æŠŠå‰ç«¯åŠ ä¸Šæª”æ¡ˆè®€å–åŠŸèƒ½ã€‚
  </script>
</body>
</html>
